<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
  <meta charset="utf-8">
  <meta name="generator" content="quarto-0.9.194">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>BATS_Val_57_Exploratory-Analysis - Taxa Richness as a funciton of latitude</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>

  <script src="site_libs/quarto-nav/quarto-nav.js"></script>
  <script src="site_libs/quarto-nav/headroom.min.js"></script>
  <script src="site_libs/clipboard/clipboard.min.js"></script>
  <meta name="quarto:offset" content="./">
  <script src="site_libs/quarto-search/autocomplete.umd.js"></script>
  <script src="site_libs/quarto-search/fuse.min.js"></script>
  <script src="site_libs/quarto-search/quarto-search.js"></script>
  <script src="site_libs/quarto-html/quarto.js"></script>
  <script src="site_libs/quarto-html/popper.min.js"></script>
  <script src="site_libs/quarto-html/tippy.umd.min.js"></script>
  <script src="site_libs/quarto-html/anchor.min.js"></script>
  <link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
  <link id="quarto-text-highlighting-styles" href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
  <script src="site_libs/bootstrap/bootstrap.min.js"></script>
  <link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
  <link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet">
  <script id="quarto-search-options" type="application/json">{
    "location": "navbar",
    "copy-button": false,
    "collapse-after": 3,
    "panel-placement": "end",
    "type": "overlay",
    "limit": 20,
    "language": {
      "search-no-results-text": "No results",
      "search-matching-documents-text": "matching documents",
      "search-copy-link-title": "Copy link to search",
      "search-hide-matches-text": "Hide additional matches",
      "search-more-match-text": "more match in this document",
      "search-more-matches-text": "more matches in this document",
      "search-clear-button-title": "Clear",
      "search-detached-cancel-button-title": "Cancel",
      "search-submit-button-title": "Submit"
    }
  }</script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel="stylesheet" href="styles.css">
</head>
<body class="fullcontent">
<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BATS_Val_57_Exploratory-Analysis</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./bv57_exploratory_taxa-diversity.html" aria-current="page">Diversity Analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./bv57_exploratory_density.html">Integrated Abundance Analysis</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./bv57_exploratory_copepod-body-vol.html">Copepod Body Size</a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">
<header id="title-block-header" class="quarto-title-block default">

<div class="quarto-title"><h1 class="title display-7">Taxa Richness as a funciton of latitude</h1></div></header>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(EcotaxaTools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>uvp_dat <span class="ot">&lt;-</span> <span class="fu">ecopart_import</span>(<span class="st">"~/BV_transect_export"</span>) <span class="co">#load in initial ecopart object</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="co"># we need to trim out the hs casts</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># One way to do that would be to hard-code indices for those but that's not reliable</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co">#So I'm using regex</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co">#get index of hs data for both par and zoo files</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>hs_index_par <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">"hs"</span>,<span class="fu">names</span>(uvp_dat<span class="sc">$</span>par_files))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>hs_index_zoo <span class="ot">&lt;-</span> <span class="fu">grep</span>(<span class="st">'hs'</span>, <span class="fu">names</span>(uvp_dat<span class="sc">$</span>zoo_files))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>uvp_dat<span class="sc">$</span>par_files <span class="ot">&lt;-</span> uvp_dat<span class="sc">$</span>par_files[<span class="sc">-</span>hs_index_par]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>uvp_dat<span class="sc">$</span>zoo_files <span class="ot">&lt;-</span> uvp_dat<span class="sc">$</span>zoo_files[<span class="sc">-</span>hs_index_zoo]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis we are going to look at the richness of different taxa along the latitudinal gradient. We’ll use simpson’s diversity index. There’s a wide range of how this is calculated but I like to do the probability of two randomly selected individuals being the same group. One important caveat for our approach here is that not all taxa are identified to the same specificity. Some are genera, some are family, some are even more broad. This can greatly influence the reliability of this index. This is particularly important to think about with Rhizaria. Those we can identify with much more specificity than other groups. For that reason, if we just did best possible taxonomic category, our biodiversity index would just be a function of overall rhizaria abundance. So I’m going to split up Rhizaria biodiversity and other zooplankton diversity. Notably, I’m excluding trichodesmium which is a phytoplankton.</p>
<section id="getting-our-data-set-up" class="level3">
<h3 class="anchored" data-anchor-id="getting-our-data-set-up">1 - Getting our data set up</h3>
<p>First, we need to set up our data frames. We only need the identification data here, not the volumes. I’m going to make two lists, one with just the Rhizaria, another with just the other zooplankton</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Rhiz_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'Rhizaria'</span>, <span class="st">'living'</span>, <span class="st">'not-living'</span>, <span class="st">'Collodaria'</span>) <span class="co">#these are going to be used as an index to keep rhizaria</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>other_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'living'</span>, <span class="st">'Actinopterygii'</span>,<span class="st">'Alciopidae'</span>,<span class="st">'Amphipoda'</span>,<span class="st">'Annelida'</span>,<span class="st">'not-living'</span>,<span class="st">'Copepoda'</span>,<span class="st">'Chaetognatha'</span>,<span class="st">'Cnidaria'</span>,<span class="st">'Crustacea'</span>,<span class="st">'Ctenophora'</span>,<span class="st">'Decapoda'</span>,<span class="st">'Echinodermata'</span>,<span class="st">'Eucalanidae'</span>,<span class="st">'Hydrozoa'</span>,<span class="st">'Ostracoda'</span>,<span class="st">'Polychaeta'</span>,<span class="st">'Pteropoda'</span>,<span class="st">'Salpidae'</span>,<span class="st">'Siphonophorae'</span>,<span class="st">'Tomopteridae'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>rhiz_dat <span class="ot">&lt;-</span> <span class="fu">add_zoo</span>(uvp_dat, names_to, <span class="st">'Rhiz_or_not'</span>, Rhiz_names, <span class="at">suppress_print =</span> T)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>other_zoop <span class="ot">&lt;-</span> <span class="fu">add_zoo</span>(uvp_dat, names_to, <span class="st">'Zoop'</span>, other_names, <span class="at">suppress_print =</span> T)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>trim_to <span class="ot">&lt;-</span> <span class="cf">function</span>(df, match_col, drop_names) {</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  rdf <span class="ot">&lt;-</span> df[<span class="fu">which</span>(<span class="sc">!</span>(df[[match_col]] <span class="sc">%in%</span> drop_names)),]</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rdf)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>rhiz_only <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rhiz_dat<span class="sc">$</span>zoo_files, trim_to, <span class="st">'Rhiz_or_not'</span>,<span class="fu">c</span>(<span class="st">'living'</span>,<span class="st">'not-living'</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>other_only <span class="ot">&lt;-</span> <span class="fu">lapply</span>(other_zoop<span class="sc">$</span>zoo_files, trim_to, <span class="st">'Zoop'</span>,<span class="fu">c</span>(<span class="st">'living'</span>,<span class="st">'not-living'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="calculating-diversity-index." class="level3">
<h3 class="anchored" data-anchor-id="calculating-diversity-index.">2 - Calculating diversity index.</h3>
<p>Now, I have two lists of tibbles: one with just the rhizaria and one with all other zooplankton. We’ll want to loop through these and assign them diversity values.</p>
<section id="lets-define-a-function-for-diversity" class="level4">
<h4 class="anchored" data-anchor-id="lets-define-a-function-for-diversity">Let’s define a function for diversity:</h4>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#' Get Simpson's Diversity Index</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co">#' </span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#' @param vect a character vector of taxa names</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>simpsons_d <span class="ot">&lt;-</span> <span class="cf">function</span>(vect) {</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="fu">table</span>(vect) <span class="sc">/</span> <span class="fu">length</span>(vect)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(prob<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now we can use that function for calculating the diversity with each cast. But first, we’ll want to separate out the casts into euphotic, upper meso, lower meso, and bathypelagic</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1200</span>,<span class="dv">4000</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>rhiz_bins <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rhiz_only, bin_taxa,db)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>zoo_bins <span class="ot">&lt;-</span> <span class="fu">lapply</span>(other_only, bin_taxa,db)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#a quicker way to get it with existing functions</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>rhiz_bins <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rhiz_bins, <span class="cf">function</span>(df) {<span class="fu">split</span>(df, <span class="at">f =</span> df[[<span class="st">'db'</span>]])})</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>zoo_bins <span class="ot">&lt;-</span> <span class="fu">lapply</span>(zoo_bins, <span class="cf">function</span>(df) {<span class="fu">split</span>(df, <span class="at">f =</span> df[[<span class="st">'db'</span>]])})</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>sim_d <span class="ot">&lt;-</span> <span class="cf">function</span>(df) {</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(df) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> df<span class="sc">$</span>x<span class="sc">/</span><span class="fu">sum</span>(df<span class="sc">$</span>x)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(prob<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>rhiz_div <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>, <span class="fu">length</span>(rhiz_bins))</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>zoo_div <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">'list'</span>, <span class="fu">length</span>(zoo_bins))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(rhiz_div) <span class="ot">&lt;-</span> <span class="fu">names</span>(rhiz_bins)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(zoo_div) <span class="ot">&lt;-</span> <span class="fu">names</span>(zoo_bins)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(rhiz_div)) {</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  rhiz_div[[i]] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(rhiz_bins[[i]], sim_d)</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  zoo_div[[i]] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(zoo_bins[[i]], sim_d)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  rhiz_div[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">db =</span> <span class="fu">names</span>(rhiz_div[[i]]),</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                              <span class="at">sim_d =</span> <span class="fu">unlist</span>(rhiz_div[[i]]),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                              <span class="at">profile_id =</span> <span class="fu">names</span>(rhiz_div[i]))</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  zoo_div[[i]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">db =</span> <span class="fu">names</span>(zoo_div[[i]]),</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                             <span class="at">sim_d =</span> <span class="fu">unlist</span>(zoo_div[[i]]),</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>                             <span class="at">profile_id =</span> <span class="fu">names</span>(zoo_div[i]))</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>rhiz_div <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, rhiz_div)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>zoo_div <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind, zoo_div)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(rhiz_div) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="fu">row.names</span>(zoo_div) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a><span class="co">#trim out the deepest observations</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>rhiz_div <span class="ot">&lt;-</span> rhiz_div[rhiz_div<span class="sc">$</span>db <span class="sc">%in%</span> <span class="fu">levels</span>(<span class="fu">cut</span>(db,db)),]</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>zoo_div <span class="ot">&lt;-</span> zoo_div[zoo_div<span class="sc">$</span>db <span class="sc">%in%</span> <span class="fu">levels</span>(<span class="fu">cut</span>(db,db)),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>And we’ll have to merge those with latitude data</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>rhiz_div <span class="ot">&lt;-</span> <span class="fu">merge</span>(rhiz_div, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(<span class="at">profile_id =</span> uvp_dat<span class="sc">$</span>meta<span class="sc">$</span>profileid,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lat =</span> uvp_dat<span class="sc">$</span>meta<span class="sc">$</span>latitude))</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>zoo_div <span class="ot">&lt;-</span> <span class="fu">merge</span>(zoo_div, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">data.frame</span>(<span class="at">profile_id =</span> uvp_dat<span class="sc">$</span>meta<span class="sc">$</span>profileid,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                             <span class="at">lat =</span> uvp_dat<span class="sc">$</span>meta<span class="sc">$</span>latitude))</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rhiz_div, <span class="fu">aes</span>(<span class="at">x =</span> lat, <span class="at">y =</span> sim_d, <span class="at">col =</span> db))<span class="sc">+</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">span =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Latitude'</span>, <span class="at">y =</span> <span class="st">'Simpsons D'</span>, <span class="at">subtitle =</span> <span class="st">'Rhizaria'</span>)<span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 18 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bv57_exploratory_taxa-diversity_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(zoo_div, <span class="fu">aes</span>(<span class="at">x =</span> lat, <span class="at">y =</span> sim_d, <span class="at">col =</span> db))<span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">stat =</span> <span class="st">'smooth'</span>, <span class="at">method =</span> <span class="st">'gam'</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">alpha =</span> .<span class="dv">6</span>, <span class="at">span =</span> <span class="dv">5</span>, <span class="at">size =</span> <span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>()<span class="sc">+</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">'Latitude'</span>, <span class="at">y =</span> <span class="st">'Simpsons D'</span>, <span class="at">subtitle =</span> <span class="st">'Other Zoops'</span>)<span class="sc">+</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ s(x, bs = "cs")'</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 19 rows containing non-finite values (stat_smooth).</code></pre>
</div>
<div class="cell-output-stderr">
<pre><code>Warning: Removed 19 rows containing missing values (geom_point).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="bv57_exploratory_taxa-diversity_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
</div>



</section>
</section>
</main> <!-- /main -->
<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    setTimeout(function() {
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->


</body></html>